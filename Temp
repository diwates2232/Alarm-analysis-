import React from 'react';
import { DataGrid } from '@mui/x-data-grid';
import { Button, Typography } from '@mui/material';
import * as XLSX from 'xlsx';

const AlarmsTable = ({ alarms = [] }) => {
  // Guard: if no alarms yet, show a message
  if (alarms.length === 0) {
    return (
      <Typography variant="h6" align="center" style={{ marginTop: 40 }}>
        No alarm records to display.
      </Typography>
    );
  }

  const exportToExcel = () => {
    const worksheet = XLSX.utils.json_to_sheet(alarms);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, 'Alarms');
    XLSX.writeFile(workbook, 'alarms.xlsx');
  };

  const columns = [
    { field: 'Sr. No', headerName: 'Sr. No', width: 90 },
    { field: 'Date', headerName: 'Date', width: 120 },
    { field: 'Time of Alarm (Local time)', headerName: 'Time', width: 150 },
    { field: 'Region', headerName: 'Region', width: 120 },
    { field: 'Rejection', headerName: 'Rejection', width: 150 },
    { field: 'CCURE Incident Priority', headerName: 'Priority', width: 150 },
    {
      field: 'Name of Person Attending Alarms (First, Last Name)',
      headerName: 'Operator',
      width: 200
    },
    { field: 'Action Taken', headerName: 'Action Taken', width: 150 },
    { field: 'Time Taken (Min)', headerName: 'Time Taken (Min)', width: 150 },
    // Add other necessary fields
  ];

  const rows = alarms.map((alarm, index) => ({
    id: index,
    ...alarm
  }));

  return (
    <div style={{ height: 600, width: '100%' }}>
      <Button
        variant="contained"
        color="primary"
        onClick={exportToExcel}
        style={{ marginBottom: 16 }}
      >
        Export to Excel
      </Button>
      <DataGrid
        rows={rows}
        columns={columns}
        getRowClassName={(params) =>
          params.row['Time Taken (Min)'] > 0 ? 'sla-breach' : ''
        }
        pageSize={10}
        rowsPerPageOptions={[10, 20, 50]}
      />
    </div>
  );
};

export default AlarmsTable;







import React, { useEffect, useState } from 'react';
import AlarmsTable from '../components/AlarmsTable';
import { getRawAlarms } from '../services/api';
import { Typography, Container } from '@mui/material';

const RawAlarms = () => {
  const [alarms, setAlarms] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    getRawAlarms()
      .then((res) => {
        setAlarms(res.data || []);
      })
      .catch((err) => {
        console.error('Failed to fetch raw alarms:', err);
        setAlarms([]);
      })
      .finally(() => {
        setLoading(false);
      });
  }, []);

  return (
    <Container style={{ marginTop: 24 }}>
      <Typography variant="h4" gutterBottom>
        Raw Alarms
      </Typography>

      {loading ? (
        <Typography>Loading alarmsâ€¦</Typography>
      ) : (
        <AlarmsTable alarms={alarms} />
      )}
    </Container>
  );
};

export default RawAlarms;


















Check bith file and solve above errors and give me Correct files


AlarmsTable.js


import React from 'react';
import { DataGrid } from '@mui/x-data-grid';
import { Button } from '@mui/material';
import * as XLSX from 'xlsx';

const AlarmsTable = ({ alarms }) => {
  const exportToExcel = () => {
    const worksheet = XLSX.utils.json_to_sheet(alarms);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, 'Alarms');
    XLSX.writeFile(workbook, 'alarms.xlsx');
  };

  const columns = [
    { field: 'Sr. No', headerName: 'Sr. No', width: 90 },
    { field: 'Date', headerName: 'Date', width: 120 },
    { field: 'Time of Alarm (Local time)', headerName: 'Time', width: 150 },
    { field: 'Region', headerName: 'Region', width: 120 },
    { field: 'Rejection', headerName: 'Rejection', width: 150 },
    { field: 'CCURE Incident Priority', headerName: 'Priority', width: 150 },
    { field: 'Name of Person Attending Alarms (First, Last Name)', headerName: 'Operator', width: 200 },
    { field: 'Action Taken', headerName: 'Action Taken', width: 150 },
    { field: 'Time Taken (Min)', headerName: 'Time Taken (Min)', width: 150 },
    // Add other necessary fields
  ];

  const rows = alarms.map((alarm, index) => ({
    id: index,
    ...alarm,
  }));

  return (
    <div style={{ height: 600, width: '100%' }}>
      <Button variant="contained" color="primary" onClick={exportToExcel}>
        Export to Excel
      </Button>
      <DataGrid
        rows={rows}
        columns={columns}
        getRowClassName={(params) =>
          params.row['Time Taken (Min)'] > 0 ? 'sla-breach' : ''
        }
        pageSize={10}
        rowsPerPageOptions={[10, 20, 50]}
      />
    </div>
  );
};

export default AlarmsTable;






RawAlarms.js


import React, { useEffect, useState } from 'react';
import AlarmsTable from '../components/AlarmsTable';
import { getRawAlarms } from '../services/api';

const RawAlarms = () => {
  const [alarms, setAlarms] = useState([]);

  useEffect(() => {
    getRawAlarms()
      .then(res => setAlarms(res.data))
      .catch(err => console.error(err));
  }, []);

  return (
    <div>
      <AlarmsTable data={alarms} />
    </div>
  );
};

export default RawAlarms;



